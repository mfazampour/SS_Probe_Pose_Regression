---
version: 1

kind: experiment

framework: pytorch

tags: [examples]
 
build:
  env_vars:
    - ["LC_ALL" , "C.UTF-8"]
  image: pytorch/pytorch:1.11.0-cuda11.3-cudnn8-runtime

  build_steps:
    - apt update
    - python -m pip install -U setuptools pip
    - apt install ffmpeg libsm6 libxext6  -y
    - apt install -y libglib2.0-0 libxrender-dev git libgl1 libgl1-mesa-glx
    - pip install -r requirements.txt
    - wandb login 8c270b01bc99a827f2a310b570e150f98b6dd278

environment:
  resources:
    cpu:
      requests: 3
      limits: 4
    memory:
      requests: 32000
      limits: 64000 
    gpu:
      requests: 1
      limits: 1
#  node_selector:
#    gpuMemory: "24"
#    nvidiaDriver: "460"

run:
  cmd:
  - python3 ./full_run_cut_torch.py -c config/config_run_seg+cut_torch_aorta_only.yml

